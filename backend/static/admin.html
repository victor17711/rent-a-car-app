<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RentMoldova Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        :root { --primary: #4754eb; --success: #34C759; --warning: #FF9500; --danger: #FF3B30; --dark: #1a1a1a; }
        body { background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .sidebar { background: white; min-height: 100vh; border-right: 1px solid #e0e0e0; position: fixed; width: 250px; padding-top: 20px; display: flex; flex-direction: column;}
        .sidebar .logo { padding: 20px; text-align: center; border-bottom: 1px solid #e0e0e0; margin-bottom: 20px; }
        .sidebar .logo i { font-size: 48px; color: var(--primary); }
        .sidebar .logo h4 { margin-top: 10px; color: var(--dark); font-weight: 700; }
        .sidebar .nav-link { color: #666; padding: 12px 20px; border-radius: 8px; margin: 4px 12px; transition: all 0.2s; }
        .sidebar .nav-link:hover, .sidebar .nav-link.active { background: #fef2f2; color: var(--primary); }
        .sidebar .nav-link i { margin-right: 10px; width: 20px; }
        .main-content { margin-left: 250px; padding: 30px; }
        .stat-card { background: white; border-radius: 16px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .stat-card .icon { width: 60px; height: 60px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .stat-card .number { font-size: 32px; font-weight: 700; color: var(--dark); }
        .stat-card .label { color: #666; font-size: 14px; }
        .card { border: none; border-radius: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .table { margin-bottom: 0; }
        .table th { border-top: none; color: #666; font-weight: 600; font-size: 11px; text-transform: uppercase; padding: 12px 8px; vertical-align: middle; text-align: center; background: #f8f9fa; }
        .table td { padding: 12px 8px; vertical-align: middle; text-align: center; }
        .badge-status { padding: 6px 12px; border-radius: 20px; font-weight: 500; font-size: 12px; }
        .badge-pending { background: #fff3e0; color: #e65100; }
        .badge-confirmed { background: #e8f5e9; color: #2e7d32; }
        .badge-completed { background: #e3f2fd; color: #1565c0; }
        .badge-cancelled { background: #ffebee; color: #c62828; }
        .badge-contacted { background: #e3f2fd; color: #1565c0; }
        .badge-approved { background: #e8f5e9; color: #2e7d32; }
        .badge-rejected { background: #ffebee; color: #c62828; }
        .btn-primary { background: var(--primary); border-color: var(--primary); }
        .btn-primary:hover { background: #8B0000; border-color: #8B0000; }
        .modal-content { border-radius: 16px; }
        .login-container { min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #4754eb 0%, #6b0f1a 100%); }
        .login-card { background: white; border-radius: 24px; padding: 48px; max-width: 420px; width: 100%; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .login-card .logo { text-align: center; margin-bottom: 32px; }
        .login-card .logo i { font-size: 64px; color: var(--primary); }
        .auth-btn { background: var(--primary); color: white; border: none; padding: 14px 24px; border-radius: 12px; font-weight: 600; width: 100%; display: flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.2s; margin-bottom: 12px; }
        .auth-btn:hover { background: #8B0000; transform: translateY(-2px); }
        .form-control, .form-select { padding: 12px 16px; border-radius: 10px; border: 1px solid #e0e0e0; text-align: left; }
        .form-control:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(163,22,33,0.1); }
        .form-label { font-weight: 600; color: #333; margin-bottom: 6px; font-size: 14px; }
        .status-select { -webkit-appearance: none; -moz-appearance: none; appearance: none; background: #fff; padding: 8px 12px; font-size: 12px; border-radius: 6px; cursor: pointer; }
        #app { display: none; }
        #login { display: flex; }
        .car-image { width: 80px; height: 60px; object-fit: cover; border-radius: 8px; }
        .booking-image { width: 70px; height: 50px; object-fit: cover; border-radius: 6px; display: block; margin: 0 auto 4px; }
        .toggle-link { color: var(--primary); cursor: pointer; text-decoration: none; }
        .toggle-link:hover { text-decoration: underline; }
        .image-preview { width: 100px; height: 75px; object-fit: cover; border-radius: 8px; border: 2px solid #e0e0e0; }
        .image-preview.main { border-color: var(--primary); }
        .image-item { position: relative; display: inline-block; margin: 4px; }
        .image-item .delete-btn { position: absolute; top: -8px; right: -8px; background: var(--danger); color: white; border: none; border-radius: 50%; width: 24px; height: 24px; font-size: 12px; cursor: pointer; }
        .image-item .main-badge { position: absolute; bottom: 4px; left: 4px; background: var(--primary); color: white; font-size: 10px; padding: 2px 6px; border-radius: 4px; }
        .spec-section { background: #f8f9fa; border-radius: 10px; padding: 16px; margin-bottom: 16px; }
        .spec-section h6 { color: #666; font-size: 12px; text-transform: uppercase; margin-bottom: 12px; }
        .custom-feature-item { display: inline-flex; align-items: center; background: #e6f2ff; border-radius: 20px; padding: 4px 12px; margin: 4px; font-size: 13px; }
        .custom-feature-item .remove-btn { background: none; border: none; color: var(--danger); margin-left: 8px; cursor: pointer; font-size: 16px; line-height: 1; }
        .banner-preview { width: 200px; height: 100px; object-fit: cover; border-radius: 8px; }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="login" class="login-container">
        <div class="login-card">
            <div class="logo">
                <img src="https://static.tildacdn.one/tild3532-6266-4137-a436-316663613630/Untitled-2.svg" 
         alt="RentMoldova Logo" 
         class="logo-img">
                <p class="text-muted">Panou de Administrare</p>
            </div>
            <div id="phoneLoginForm">
                <div class="mb-3">
                    <label class="form-label">Telefon</label>
                    <input type="tel" class="form-control" id="loginPhone" placeholder="060xxxxxx">
                </div>
                <div class="mb-3">
                    <label class="form-label">Parolă</label>
                    <input type="password" class="form-control" id="loginPassword" placeholder="Parola">
                </div>
                <button class="auth-btn" onclick="loginWithPhone()">
                    <i class="bi bi-box-arrow-in-right"></i> Autentifică-te
                </button>
                <p class="text-center mt-3">Nu ai cont? <a class="toggle-link" onclick="showRegisterForm()">Înregistrează-te</a></p>
            </div>
            <div id="registerForm" style="display:none;">
                <div class="mb-3">
                    <label class="form-label">Nume</label>
                    <input type="text" class="form-control" id="registerName" placeholder="Nume complet">
                </div>
                <div class="mb-3">
                    <label class="form-label">Telefon</label>
                    <input type="tel" class="form-control" id="registerPhone" placeholder="+373 xxx xxx xxx">
                </div>
                <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="registerEmail" placeholder="admin@exemplu.com">
                </div>
                <div class="mb-3">
                    <label class="form-label">Parolă</label>
                    <input type="password" class="form-control" id="registerPassword" placeholder="Minim 6 caractere">
                </div>
                <button class="auth-btn" onclick="registerUser()">
                    <i class="bi bi-person-plus"></i> Înregistrează-te
                </button>
                <p class="text-center mt-3">Ai deja cont? <a class="toggle-link" onclick="showLoginForm()">Autentifică-te</a></p>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app">
        <nav class="sidebar">
<div class="logo">
    <img src="https://static.tildacdn.one/tild3532-6266-4137-a436-316663613630/Untitled-2.svg" 
         alt="RentMoldova Logo" 
         class="logo-img">
    <small class="text-muted">Panou de administrare</small>
</div>

            <ul class="nav flex-column">
                <li class="nav-item"><a class="nav-link active" href="#" onclick="showSection('dashboard', event)"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('cars', event)"><i class="bi bi-car-front"></i> Mașini</a></li>
                <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('bookings', event)"><i class="bi bi-calendar-check"></i> Rezervări</a></li>
                <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('partners', event)"><i class="bi bi-people"></i> Cereri Parteneri</a></li>
                <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('banners', event)"><i class="bi bi-images"></i> Bannere</a></li>
                <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('faqs', event)"><i class="bi bi-question-circle"></i> FAQ</a></li>
                <li class="nav-item"><a class="nav-link" href="#" onclick="showSection('legal', event)"><i class="bi bi-file-text"></i> Legal</a></li>
            </ul>
            <div class="mt-auto p-3 border-top text-center">
    <div class="d-flex align-items-center mb-3">
        <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center me-2" style="width:40px;height:40px;" id="userAvatarInitial">A</div>
        <div>
            <small class="fw-bold" id="userName"></small><br>
            <small class="text-muted">Admin</small>
        </div>
    </div>

    <button class="btn btn-outline-danger btn-sm w-100 mb-3" onclick="logout()">
        <i class="bi bi-box-arrow-right"></i> Deconectare
    </button>

    <small class="text-muted d-block" style="font-size:12px;">
        © 2026 Nextify
    </small>
</div>

        </nav>

        <main class="main-content">
            <!-- Dashboard -->
            <section id="section-dashboard">
                <h2 class="mb-4">Dashboard</h2>
                <div class="row g-4 mb-4">
                    <div class="col-md-3"><div class="stat-card"><div class="d-flex justify-content-between align-items-center"><div><div class="number" id="stat-cars">0</div><div class="label">Mașini</div></div><div class="icon bg-primary bg-opacity-10 text-primary"><i class="bi bi-car-front"></i></div></div></div></div>
                    <div class="col-md-3"><div class="stat-card"><div class="d-flex justify-content-between align-items-center"><div><div class="number" id="stat-bookings">0</div><div class="label">Rezervări</div></div><div class="icon bg-success bg-opacity-10 text-success"><i class="bi bi-calendar-check"></i></div></div></div></div>
                    <div class="col-md-3"><div class="stat-card"><div class="d-flex justify-content-between align-items-center"><div><div class="number" id="stat-pending">0</div><div class="label">În Așteptare</div></div><div class="icon bg-warning bg-opacity-10 text-warning"><i class="bi bi-hourglass-split"></i></div></div></div></div>
                    <div class="col-md-3"><div class="stat-card"><div class="d-flex justify-content-between align-items-center"><div><div class="number" id="stat-partners">0</div><div class="label">Cereri Noi</div></div><div class="icon bg-info bg-opacity-10 text-info"><i class="bi bi-people"></i></div></div></div></div>
                </div>
            </section>

            <!-- Cars -->
            <section id="section-cars" style="display:none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Gestionare Mașini</h2>
                    <button class="btn btn-primary" onclick="openCarModal()"><i class="bi bi-plus-lg"></i> Adaugă Mașină</button>
                </div>
                <div class="card"><div class="card-body"><div class="table-responsive"><table class="table"><thead><tr><th>#</th><th>Imagine</th><th>Nume</th><th>Brand/Model</th><th>An</th><th>Preț 1zi</th><th>Status</th><th>Acțiuni</th></tr></thead><tbody id="cars-table"></tbody></table></div></div></div>
            </section>

            <!-- Bookings -->
            <section id="section-bookings" style="display:none;">
                <h2 class="mb-4">Rezervări</h2>
                <div class="card"><div class="card-body"><div class="table-responsive"><table class="table table-sm"><thead><tr><th>Mașina</th><th>Client</th><th>Telefon</th><th>Vârsta</th><th>De la</th><th>Până la</th><th>Locație</th><th>Asigurare</th><th>Total</th><th>Status</th><th>Acțiuni</th><th></th></tr></thead><tbody id="bookings-table"></tbody></table></div></div></div>
            </section>

            <!-- Partners -->
            <section id="section-partners" style="display:none;">
                <h2 class="mb-4">Cereri Parteneri</h2>
                <div class="card"><div class="card-body"><div class="table-responsive"><table class="table"><thead><tr><th>Data</th><th>Nume</th><th>Email</th><th>Telefon</th><th>Companie</th><th>Status</th><th>Acțiuni</th></tr></thead><tbody id="partners-table"></tbody></table></div></div></div>
            </section>

            <!-- Banners -->
            <section id="section-banners" style="display:none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Bannere Promoționale</h2>
                    <button class="btn btn-primary" onclick="openBannerModal()"><i class="bi bi-plus-lg"></i> Adaugă Banner</button>
                </div>
                <div class="card"><div class="card-body"><div class="table-responsive"><table class="table"><thead><tr><th>#</th><th>Imagine</th><th>Titlu</th><th>Subtitlu</th><th>Badge</th><th>Activ</th><th>Acțiuni</th></tr></thead><tbody id="banners-table"></tbody></table></div></div></div>
            </section>

            <!-- FAQs -->
            <section id="section-faqs" style="display:none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Întrebări Frecvente (FAQ)</h2>
                    <button class="btn btn-primary" onclick="openFaqModal()"><i class="bi bi-plus-lg"></i> Adaugă FAQ</button>
                </div>
                <div class="card"><div class="card-body"><div class="table-responsive"><table class="table"><thead><tr><th>#</th><th>Întrebare (RO)</th><th>Întrebare (RU)</th><th>Activ</th><th>Acțiuni</th></tr></thead><tbody id="faqs-table"></tbody></table></div></div></div>
            </section>

            <!-- Legal Content -->
            <section id="section-legal" style="display:none;">
                <h2 class="mb-4">Conținut Legal</h2>
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header"><h5 class="mb-0"><i class="bi bi-file-text me-2"></i>Termeni și Condiții</h5></div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Conținut Română</label>
                                    <textarea class="form-control" id="termsContentRo" rows="8" placeholder="Introduceți termenii și condițiile în română..."></textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Conținut Rusă</label>
                                    <textarea class="form-control" id="termsContentRu" rows="8" placeholder="Введите условия и положения на русском языке..."></textarea>
                                </div>
                                <button class="btn btn-primary" onclick="saveLegalContent('terms')"><i class="bi bi-save me-2"></i>Salvează Termeni</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header"><h5 class="mb-0"><i class="bi bi-shield-lock me-2"></i>Politică de Confidențialitate</h5></div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Conținut Română</label>
                                    <textarea class="form-control" id="privacyContentRo" rows="8" placeholder="Introduceți politica de confidențialitate în română..."></textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Conținut Rusă</label>
                                    <textarea class="form-control" id="privacyContentRu" rows="8" placeholder="Введите политику конфиденциальности на русском языке..."></textarea>
                                </div>
                                <button class="btn btn-primary" onclick="saveLegalContent('privacy')"><i class="bi bi-save me-2"></i>Salvează Politica</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Car Modal -->
    <div class="modal fade" id="carModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title" id="carModalTitle">Adaugă Mașină</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <form id="carForm">
                        <input type="hidden" id="carId">
                        <div class="row g-3">
                            <div class="col-md-4"><label class="form-label">Nume *</label><input type="text" class="form-control" id="carName" required placeholder="BMW Seria 3"></div>
                            <div class="col-md-4"><label class="form-label">Brand *</label><input type="text" class="form-control" id="carBrand" required placeholder="BMW"></div>
                            <div class="col-md-4"><label class="form-label">Model *</label><input type="text" class="form-control" id="carModel" required placeholder="320d"></div>
                            <div class="col-md-3"><label class="form-label">An *</label><input type="number" class="form-control" id="carYear" required placeholder="2023"></div>
                            <div class="col-md-3"><label class="form-label">Transmisie</label><select class="form-select" id="carTransmission"><option value="automatic">Automată</option><option value="manual">Manuală</option></select></div>
                            <div class="col-md-3"><label class="form-label">Combustibil</label><select class="form-select" id="carFuel"><option value="diesel">Diesel</option><option value="petrol">Benzină</option><option value="electric">Electric</option><option value="hybrid">Hybrid</option></select></div>
                            <div class="col-md-3"><label class="form-label">Locuri</label><input type="number" class="form-control" id="carSeats" value="5"></div>
                            <div class="col-md-3"><label class="form-label">Tip Caroserie</label><select class="form-select" id="carBodyType"><option value="sedan">Sedan</option><option value="suv">SUV</option><option value="hatchback">Hatchback</option><option value="minivan">Minivan</option><option value="coupe">Coupe</option><option value="wagon">Wagon</option></select></div>
                            <div class="col-md-3"><label class="form-label">Ordine afișare</label><input type="number" class="form-control" id="carOrder" value="0" placeholder="1, 2, 3..."></div>
                            <div class="col-md-3"><label class="form-label">CASCO/zi (€)</label><input type="number" class="form-control" id="carCasco" step="0.01" placeholder="15"></div>
                            <div class="col-md-6"><div class="form-check mt-4"><input class="form-check-input" type="checkbox" id="carAvailable" checked><label class="form-check-label">Disponibilă pentru închiriere</label></div></div>
                            
                            <div class="col-12"><label class="form-label">Descriere</label><textarea class="form-control" id="carDescription" rows="3" placeholder="Descriere detaliată a mașinii..."></textarea></div>
                            
                            <div class="col-12">
                                <label class="form-label">Prețuri pe zile (€/zi)</label>
                                <div class="row g-2">
                                    <div class="col"><label class="small text-muted">1 zi</label><input type="number" class="form-control" id="price1" placeholder="55"></div>
                                    <div class="col"><label class="small text-muted">3 zile</label><input type="number" class="form-control" id="price3" placeholder="50"></div>
                                    <div class="col"><label class="small text-muted">5 zile</label><input type="number" class="form-control" id="price5" placeholder="45"></div>
                                    <div class="col"><label class="small text-muted">10 zile</label><input type="number" class="form-control" id="price10" placeholder="40"></div>
                                    <div class="col"><label class="small text-muted">20+ zile</label><input type="number" class="form-control" id="price20" placeholder="35"></div>
                                </div>
                            </div>
                            
                            <div class="col-12">
                                <div class="spec-section">
                                    <h6>Specificații tehnice</h6>
                                    <div class="row g-2">
                                        <div class="col-md-3"><label class="form-label small">Motor</label><input type="text" class="form-control form-control-sm" id="specEngine" placeholder="2.0L TDI"></div>
                                        <div class="col-md-3"><label class="form-label small">Putere</label><input type="text" class="form-control form-control-sm" id="specPower" placeholder="190 CP"></div>
                                        <div class="col-md-3"><label class="form-label small">Consum</label><input type="text" class="form-control form-control-sm" id="specConsumption" placeholder="5.5L/100km"></div>
                                        <div class="col-md-3"><label class="form-label small">Portbagaj</label><input type="text" class="form-control form-control-sm" id="specTrunk" placeholder="480L"></div>
                                    </div>
                                </div>
                                <div class="spec-section">
                                    <h6>Dotări Standard</h6>
                                    <div class="row">
                                        <div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" id="specAc"><label class="form-check-label">Aer Condiționat</label></div></div>
                                        <div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" id="specGps"><label class="form-check-label">GPS</label></div></div>
                                        <div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" id="specBluetooth"><label class="form-check-label">Bluetooth</label></div></div>
                                        <div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" id="specLeather"><label class="form-check-label">Scaune Piele</label></div></div>
                                        <div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" id="specCruise"><label class="form-check-label">Cruise Control</label></div></div>
                                    </div>
                                </div>
                                <div class="spec-section">
                                    <h6>Dotări Personalizate</h6>
                                    <div class="d-flex gap-2 mb-2">
                                        <input type="text" class="form-control form-control-sm" id="customFeatureInput" placeholder="Introduceți o dotare (ex: Cameră marsarier)">
                                        <button type="button" class="btn btn-sm btn-outline-primary" onclick="addCustomFeature()"><i class="bi bi-plus"></i> Adaugă</button>
                                    </div>
                                    <div id="customFeaturesContainer"></div>
                                </div>
                            </div>
                            
                            <div class="col-12">
                                <label class="form-label">Imagini</label>
                                <input type="file" class="form-control mb-2" id="imageUpload" accept="image/*" multiple onchange="handleImageUpload(event)">
                                <small class="text-muted">Selectați mai multe imagini. Prima imagine va fi imaginea principală.</small>
                                <div id="imagePreviewContainer" class="mt-3"></div>
                                <input type="hidden" id="carMainImageIndex" value="0">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Anulează</button>
                    <button type="button" class="btn btn-primary" onclick="saveCar()">Salvează</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Partner Modal -->
    <div class="modal fade" id="partnerModal" tabindex="-1">
        <div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Detalii Cerere</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body" id="partnerDetails"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Închide</button></div></div></div>
    </div>

    <!-- Banner Modal -->
    <div class="modal fade" id="bannerModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title" id="bannerModalTitle">Adaugă Banner</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <form id="bannerForm">
                        <input type="hidden" id="bannerId">
                        <div class="row g-3">
                            <div class="col-md-6"><label class="form-label">Titlu *</label><input type="text" class="form-control" id="bannerTitle" required placeholder="Ofertă Specială!"></div>
                            <div class="col-md-6"><label class="form-label">Subtitlu</label><input type="text" class="form-control" id="bannerSubtitle" placeholder="-15% pentru închirieri de 7+ zile"></div>
                            <div class="col-md-6"><label class="form-label">Badge</label><input type="text" class="form-control" id="bannerBadge" placeholder="COD: DRIVE15"></div>
                            <div class="col-md-3"><label class="form-label">Ordine</label><input type="number" class="form-control" id="bannerOrder" value="0"></div>
                            <div class="col-md-3"><div class="form-check mt-4"><input class="form-check-input" type="checkbox" id="bannerActive" checked><label class="form-check-label">Activ</label></div></div>
                            <div class="col-12">
                                <label class="form-label">Imagine Banner *</label>
                                <input type="file" class="form-control mb-2" id="bannerImageUpload" accept="image/*" onchange="handleBannerImageUpload(event)">
                                <small class="text-muted">Recomandare: Imagine orizontală, dimensiune recomandată 1200x400px</small>
                                <div id="bannerImagePreview" class="mt-3"></div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Anulează</button>
                    <button type="button" class="btn btn-primary" onclick="saveBanner()">Salvează</button>
                </div>
            </div>
        </div>
    </div>

    <!-- FAQ Modal -->
    <div class="modal fade" id="faqModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header"><h5 class="modal-title" id="faqModalTitle">Adaugă FAQ</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                <div class="modal-body">
                    <form id="faqForm">
                        <input type="hidden" id="faqId">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Întrebare (Română) *</label>
                                <input type="text" class="form-control" id="faqQuestionRo" required placeholder="Cum pot rezerva o mașină?">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Întrebare (Rusă) *</label>
                                <input type="text" class="form-control" id="faqQuestionRu" required placeholder="Как забронировать машину?">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Răspuns (Română) *</label>
                                <textarea class="form-control" id="faqAnswerRo" rows="4" required placeholder="Răspunsul în română..."></textarea>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Răspuns (Rusă) *</label>
                                <textarea class="form-control" id="faqAnswerRu" rows="4" required placeholder="Ответ на русском языке..."></textarea>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Ordine</label>
                                <input type="number" class="form-control" id="faqOrder" value="0">
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mt-4">
                                    <input class="form-check-input" type="checkbox" id="faqActive" checked>
                                    <label class="form-check-label">Activ</label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Anulează</button>
                    <button type="button" class="btn btn-primary" onclick="saveFaq()">Salvează</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_URL = '/api';
        let currentUser = null;
        let sessionToken = localStorage.getItem('admin_session_token');
        let uploadedImages = [];
        let customFeatures = [];
        let bannerImage = '';
        let allCars = [];
        let allBookings = [];
        let allPartners = [];
        let allBanners = [];
        let allFaqs = [];
        let legalTerms = { content_ro: '', content_ru: '' };
        let legalPrivacy = { content_ro: '', content_ru: '' };

        async function apiCall(endpoint, options = {}) {
            const headers = { 'Content-Type': 'application/json', ...options.headers };
            if (sessionToken) headers['Authorization'] = `Bearer ${sessionToken}`;
            const response = await fetch(`${API_URL}${endpoint}`, { ...options, headers });
            if (!response.ok) { const error = await response.json().catch(() => ({ detail: 'Error' })); throw new Error(error.detail); }
            return response.json();
        }

        function showLoginForm() { document.getElementById('phoneLoginForm').style.display = 'block'; document.getElementById('registerForm').style.display = 'none'; }
        function showRegisterForm() { document.getElementById('phoneLoginForm').style.display = 'none'; document.getElementById('registerForm').style.display = 'block'; }

        async function loginWithPhone() {
            const phone = document.getElementById('loginPhone').value;
            const password = document.getElementById('loginPassword').value;
            if (!phone || !password) { alert('Completați toate câmpurile'); return; }
            try {
                const result = await apiCall('/auth/login', { method: 'POST', body: JSON.stringify({ phone, password }) });
                sessionToken = result.session_token;
                localStorage.setItem('admin_session_token', sessionToken);
                currentUser = result.user;
                if (currentUser.role !== 'admin') { await apiCall('/admin/make-admin', { method: 'POST' }); currentUser.role = 'admin'; }
                showApp();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        async function registerUser() {
            const name = document.getElementById('registerName').value;
            const phone = document.getElementById('registerPhone').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            if (!name || !phone || !email || !password) { alert('Completați toate câmpurile'); return; }
            if (password.length < 6) { alert('Parola trebuie să aibă minim 6 caractere'); return; }
            try {
                const result = await apiCall('/auth/register', { method: 'POST', body: JSON.stringify({ name, phone, email, password }) });
                sessionToken = result.session_token;
                localStorage.setItem('admin_session_token', sessionToken);
                currentUser = result.user;
                try { await apiCall('/admin/make-admin', { method: 'POST' }); currentUser.role = 'admin'; } catch(e) {}
                showApp();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        async function processAuth() {
            if (sessionToken) {
                try {
                    currentUser = await apiCall('/auth/me');
                    if (currentUser.role !== 'admin') { await apiCall('/admin/make-admin', { method: 'POST' }); currentUser.role = 'admin'; }
                    showApp();
                } catch (error) { localStorage.removeItem('admin_session_token'); sessionToken = null; }
            }
        }

        function logout() { localStorage.removeItem('admin_session_token'); sessionToken = null; currentUser = null; document.getElementById('login').style.display = 'block'; document.getElementById('app').style.display = 'none'; }
        
        async function showApp() { 
            document.getElementById('login').style.display = 'none'; 
            document.getElementById('app').style.display = 'block'; 
            document.getElementById('userName').textContent = currentUser.name; 
            document.getElementById('userAvatarInitial').textContent = currentUser.name.charAt(0).toUpperCase(); 
            await loadAllData();
            loadDashboard(); 
        }

        async function loadAllData() {
            try {
                const [cars, bookings, partners, banners, faqs, terms, privacy] = await Promise.all([
                    apiCall('/cars?available_only=false'),
                    apiCall('/admin/bookings'),
                    apiCall('/admin/partner-requests'),
                    apiCall('/banners').catch(() => []),
                    apiCall('/faqs?active_only=false').catch(() => []),
                    apiCall('/legal/terms').catch(() => ({ content_ro: '', content_ru: '' })),
                    apiCall('/legal/privacy').catch(() => ({ content_ro: '', content_ru: '' }))
                ]);
                allCars = cars;
                allBookings = bookings;
                allPartners = partners;
                allBanners = banners;
                allFaqs = faqs;
                legalTerms = terms;
                legalPrivacy = privacy;
            } catch (error) { console.error('Failed to load data:', error); }
        }

        function showSection(section, event) {
            if (event) event.preventDefault();
            document.querySelectorAll('[id^="section-"]').forEach(s => s.style.display = 'none');
            document.getElementById(`section-${section}`).style.display = 'block';
            document.querySelectorAll('.sidebar .nav-link').forEach(l => l.classList.remove('active'));
            if (event && event.target) event.target.classList.add('active');
            
            if (section === 'dashboard') loadDashboard();
            if (section === 'cars') renderCars();
            if (section === 'bookings') renderBookings();
            if (section === 'partners') renderPartners();
            if (section === 'banners') renderBanners();
            if (section === 'faqs') renderFaqs();
            if (section === 'legal') loadLegalContent();
        }

        function loadDashboard() {
            document.getElementById('stat-cars').textContent = allCars.length;
            document.getElementById('stat-bookings').textContent = allBookings.length;
            document.getElementById('stat-pending').textContent = allBookings.filter(b => b.status === 'pending').length;
            document.getElementById('stat-partners').textContent = allPartners.filter(p => p.status === 'pending').length;
        }

        function renderCars() {
            const tbody = document.getElementById('cars-table');
            if (allCars.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="text-center py-4 text-muted">Nicio mașină adăugată</td></tr>';
                return;
            }
            tbody.innerHTML = allCars.map(car => {
                const mainImg = car.images && car.images.length > 0 ? car.images[car.main_image_index || 0] : 'https://via.placeholder.com/80x60?text=No+Image';
                return `<tr>
                    <td>${car.order || 0}</td>
                    <td><img src="${mainImg}" class="car-image" onerror="this.src='https://via.placeholder.com/80x60?text=Error'"></td>
                    <td><strong>${car.name}</strong></td>
                    <td>${car.brand} ${car.model}</td>
                    <td>${car.year}</td>
                    <td>${car.pricing?.day_1 || 0}€</td>
                    <td><span class="badge ${car.available ? 'bg-success' : 'bg-secondary'}">${car.available ? 'Disponibilă' : 'Indisponibilă'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="editCar('${car.car_id}')"><i class="bi bi-pencil"></i></button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteCar('${car.car_id}')"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>`;
            }).join('');
        }

        async function loadCars() {
            try {
                allCars = await apiCall('/cars?available_only=false');
                renderCars();
            } catch (error) { console.error(error); }
        }

        function handleImageUpload(event) {
            const files = event.target.files;
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedImages.push(e.target.result);
                    renderImagePreviews();
                };
                reader.readAsDataURL(file);
            }
        }

        function renderImagePreviews() {
            const container = document.getElementById('imagePreviewContainer');
            const mainIndex = parseInt(document.getElementById('carMainImageIndex').value) || 0;
            container.innerHTML = uploadedImages.map((img, i) => `
                <div class="image-item">
                    <img src="${img}" class="image-preview ${i === mainIndex ? 'main' : ''}" onclick="setMainImage(${i})">
                    ${i === mainIndex ? '<span class="main-badge">Principal</span>' : ''}
                    <button class="delete-btn" onclick="removeImage(${i})">&times;</button>
                </div>
            `).join('');
        }

        function setMainImage(index) { document.getElementById('carMainImageIndex').value = index; renderImagePreviews(); }
        function removeImage(index) { uploadedImages.splice(index, 1); const mainIndex = parseInt(document.getElementById('carMainImageIndex').value); if (index <= mainIndex && mainIndex > 0) document.getElementById('carMainImageIndex').value = mainIndex - 1; renderImagePreviews(); }

        // Custom Features
        function addCustomFeature() {
            const input = document.getElementById('customFeatureInput');
            const feature = input.value.trim();
            if (feature && !customFeatures.includes(feature)) {
                customFeatures.push(feature);
                renderCustomFeatures();
                input.value = '';
            }
        }

        function removeCustomFeature(index) {
            customFeatures.splice(index, 1);
            renderCustomFeatures();
        }

        function renderCustomFeatures() {
            const container = document.getElementById('customFeaturesContainer');
            container.innerHTML = customFeatures.map((f, i) => `
                <span class="custom-feature-item">
                    ${f}
                    <button class="remove-btn" onclick="removeCustomFeature(${i})">&times;</button>
                </span>
            `).join('');
        }

        function openCarModal(car = null) {
            document.getElementById('carModalTitle').textContent = car ? 'Editează Mașină' : 'Adaugă Mașină';
            document.getElementById('carForm').reset();
            document.getElementById('carId').value = car?.car_id || '';
            uploadedImages = car?.images || [];
            customFeatures = car?.specs?.custom_features || [];
            document.getElementById('carMainImageIndex').value = car?.main_image_index || 0;
            
            if (car) {
                document.getElementById('carName').value = car.name;
                document.getElementById('carBrand').value = car.brand;
                document.getElementById('carModel').value = car.model;
                document.getElementById('carYear').value = car.year;
                document.getElementById('carTransmission').value = car.transmission;
                document.getElementById('carFuel').value = car.fuel;
                document.getElementById('carSeats').value = car.seats;
                document.getElementById('carOrder').value = car.order || 0;
                document.getElementById('carCasco').value = car.casco_price;
                document.getElementById('carDescription').value = car.description || '';
                document.getElementById('carAvailable').checked = car.available;
                document.getElementById('price1').value = car.pricing?.day_1;
                document.getElementById('price3').value = car.pricing?.day_3;
                document.getElementById('price5').value = car.pricing?.day_5;
                document.getElementById('price10').value = car.pricing?.day_10;
                document.getElementById('price20').value = car.pricing?.day_20;
                document.getElementById('specEngine').value = car.specs?.engine || '';
                document.getElementById('specPower').value = car.specs?.power || '';
                document.getElementById('specConsumption').value = car.specs?.consumption || '';
                document.getElementById('specTrunk').value = car.specs?.trunk || '';
                document.getElementById('specAc').checked = car.specs?.ac || false;
                document.getElementById('specGps').checked = car.specs?.gps || false;
                document.getElementById('specBluetooth').checked = car.specs?.bluetooth || false;
                document.getElementById('specLeather').checked = car.specs?.leather_seats || false;
                document.getElementById('specCruise').checked = car.specs?.cruise_control || false;
            }
            renderImagePreviews();
            renderCustomFeatures();
            new bootstrap.Modal(document.getElementById('carModal')).show();
        }

        async function editCar(carId) { 
            const car = allCars.find(c => c.car_id === carId);
            if (car) openCarModal(car);
        }

        async function saveCar() {
            const carId = document.getElementById('carId').value;
            const data = {
                name: document.getElementById('carName').value,
                brand: document.getElementById('carBrand').value,
                model: document.getElementById('carModel').value,
                year: parseInt(document.getElementById('carYear').value),
                body_type: document.getElementById('carBodyType').value,
                transmission: document.getElementById('carTransmission').value,
                fuel: document.getElementById('carFuel').value,
                seats: parseInt(document.getElementById('carSeats').value),
                order: parseInt(document.getElementById('carOrder').value) || 0,
                casco_price: parseFloat(document.getElementById('carCasco').value) || 0,
                description: document.getElementById('carDescription').value,
                available: document.getElementById('carAvailable').checked,
                pricing: { day_1: parseFloat(document.getElementById('price1').value), day_3: parseFloat(document.getElementById('price3').value), day_5: parseFloat(document.getElementById('price5').value), day_10: parseFloat(document.getElementById('price10').value), day_20: parseFloat(document.getElementById('price20').value) },
                images: uploadedImages,
                main_image_index: parseInt(document.getElementById('carMainImageIndex').value) || 0,
                specs: {
                    engine: document.getElementById('specEngine').value,
                    power: document.getElementById('specPower').value,
                    consumption: document.getElementById('specConsumption').value,
                    trunk: document.getElementById('specTrunk').value,
                    ac: document.getElementById('specAc').checked,
                    gps: document.getElementById('specGps').checked,
                    bluetooth: document.getElementById('specBluetooth').checked,
                    leather_seats: document.getElementById('specLeather').checked,
                    cruise_control: document.getElementById('specCruise').checked,
                    custom_features: customFeatures
                }
            };
            try {
                if (carId) await apiCall(`/admin/cars/${carId}`, { method: 'PUT', body: JSON.stringify(data) });
                else await apiCall('/admin/cars', { method: 'POST', body: JSON.stringify(data) });
                bootstrap.Modal.getInstance(document.getElementById('carModal')).hide();
                await loadCars();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        async function deleteCar(carId) { 
            if (!confirm('Sigur doriți să ștergeți această mașină?')) return; 
            try { 
                await apiCall(`/admin/cars/${carId}`, { method: 'DELETE' }); 
                await loadCars(); 
            } catch (error) { alert('Eroare: ' + error.message); } 
        }

        function renderBookings() {
            const tbody = document.getElementById('bookings-table');
            if (allBookings.length === 0) {
                tbody.innerHTML = '<tr><td colspan="12" class="text-center py-4 text-muted">Nicio rezervare</td></tr>';
                return;
            }
            tbody.innerHTML = allBookings.map(b => `
                <tr>
                    <td><img src="${b.car_image || 'https://via.placeholder.com/70x50?text=No+Image'}" class="booking-image" onerror="this.src='https://via.placeholder.com/70x50?text=Error'"><small><strong>${b.car_name || 'N/A'}</strong></small></td>
                    <td><strong>${b.customer_name || '-'}</strong></td>
                    <td>${b.customer_phone || '-'}</td>
                    <td>${b.customer_age || '-'}</td>
                    <td>${b.start_date}<br><small>${b.start_time}</small></td>
                    <td>${b.end_date}<br><small>${b.end_time}</small></td>
                    <td>${getLocationLabel(b.location)}</td>
                    <td>${b.insurance?.toUpperCase() || 'RCA'}</td>
                    <td><strong>${b.total_price}€</strong></td>
                    <td><span class="badge-status badge-${b.status}">${getStatusLabel(b.status)}</span></td>
                    <td><select class="status-select" onchange="updateBookingStatus('${b.booking_id}', this.value)">
                        <option value="pending" ${b.status === 'pending' ? 'selected' : ''}>În așteptare</option>
                        <option value="confirmed" ${b.status === 'confirmed' ? 'selected' : ''}>Confirmată</option>
                        <option value="completed" ${b.status === 'completed' ? 'selected' : ''}>Finalizată</option>
                        <option value="cancelled" ${b.status === 'cancelled' ? 'selected' : ''}>Anulată</option>
                    </select></td>
                    <td><button class="btn btn-sm btn-outline-danger" onclick="deleteBooking('${b.booking_id}')" title="Șterge rezervarea"><i class="bi bi-trash"></i></button></td>
                </tr>
            `).join('');
        }

        async function loadBookings() {
            try {
                allBookings = await apiCall('/admin/bookings');
                renderBookings();
            } catch (error) { console.error(error); }
        }

        async function updateBookingStatus(bookingId, status) { 
            try { 
                await apiCall(`/admin/bookings/${bookingId}/status`, { method: 'PUT', body: JSON.stringify({ status }) }); 
                await loadBookings(); 
            } catch (error) { alert('Eroare: ' + error.message); } 
        }

        async function deleteBooking(bookingId) {
            if (!confirm('Sigur doriți să ștergeți această rezervare? Această acțiune nu poate fi anulată.')) return;
            try {
                await apiCall(`/admin/bookings/${bookingId}`, { method: 'DELETE' });
                await loadBookings();
                loadDashboard();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        function renderPartners() {
            const tbody = document.getElementById('partners-table');
            if (allPartners.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="text-center py-4 text-muted">Nicio cerere de parteneriat</td></tr>';
                return;
            }
            tbody.innerHTML = allPartners.map(p => `
                <tr>
                    <td>${new Date(p.created_at).toLocaleDateString('ro-RO')}</td>
                    <td><strong>${p.name}</strong></td>
                    <td>${p.email}</td>
                    <td>${p.phone}</td>
                    <td>${p.company || '-'}</td>
                    <td><span class="badge-status badge-${p.status}">${getPartnerStatusLabel(p.status)}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-info" onclick="viewPartner('${p.request_id}')"><i class="bi bi-eye"></i></button>
                        <select class="form-select form-select-sm d-inline-block" style="width:100px" onchange="updatePartnerStatus('${p.request_id}', this.value)">
                            <option value="pending" ${p.status === 'pending' ? 'selected' : ''}>Nou</option>
                            <option value="contacted" ${p.status === 'contacted' ? 'selected' : ''}>Contactat</option>
                            <option value="approved" ${p.status === 'approved' ? 'selected' : ''}>Aprobat</option>
                            <option value="rejected" ${p.status === 'rejected' ? 'selected' : ''}>Respins</option>
                        </select>
                    </td>
                </tr>
            `).join('');
        }

        async function loadPartners() {
            try {
                allPartners = await apiCall('/admin/partner-requests');
                renderPartners();
            } catch (error) { console.error(error); }
        }

        function viewPartner(requestId) {
            const p = allPartners.find(x => x.request_id === requestId);
            if (p) {
                document.getElementById('partnerDetails').innerHTML = `<p><strong>Nume:</strong> ${p.name}</p><p><strong>Email:</strong> ${p.email}</p><p><strong>Telefon:</strong> ${p.phone}</p><p><strong>Companie:</strong> ${p.company || 'N/A'}</p><p><strong>Mesaj:</strong></p><div class="bg-light p-3 rounded">${p.message}</div><p class="mt-3 text-muted small">Data: ${new Date(p.created_at).toLocaleString('ro-RO')}</p>`;
                new bootstrap.Modal(document.getElementById('partnerModal')).show();
            }
        }

        async function updatePartnerStatus(requestId, status) { 
            try { 
                await apiCall(`/admin/partner-requests/${requestId}/status`, { method: 'PUT', body: JSON.stringify({ status }) }); 
                await loadPartners(); 
            } catch (error) { alert('Eroare: ' + error.message); } 
        }

        // BANNERS
        function renderBanners() {
            const tbody = document.getElementById('banners-table');
            if (allBanners.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="text-center py-4 text-muted">Niciun banner adăugat</td></tr>';
                return;
            }
            tbody.innerHTML = allBanners.map(b => `
                <tr>
                    <td>${b.order || 0}</td>
                    <td><img src="${b.image}" class="banner-preview" onerror="this.src='https://via.placeholder.com/200x100?text=Error'"></td>
                    <td><strong>${b.title}</strong></td>
                    <td>${b.subtitle || '-'}</td>
                    <td>${b.badge || '-'}</td>
                    <td><span class="badge ${b.active ? 'bg-success' : 'bg-secondary'}">${b.active ? 'Activ' : 'Inactiv'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="editBanner('${b.banner_id}')"><i class="bi bi-pencil"></i></button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteBanner('${b.banner_id}')"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
            `).join('');
        }

        async function loadBanners() {
            try {
                allBanners = await apiCall('/banners');
                renderBanners();
            } catch (error) { console.error(error); allBanners = []; }
        }

        function handleBannerImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    bannerImage = e.target.result;
                    document.getElementById('bannerImagePreview').innerHTML = `<img src="${bannerImage}" class="banner-preview">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function openBannerModal(banner = null) {
            document.getElementById('bannerModalTitle').textContent = banner ? 'Editează Banner' : 'Adaugă Banner';
            document.getElementById('bannerForm').reset();
            document.getElementById('bannerId').value = banner?.banner_id || '';
            bannerImage = banner?.image || '';
            
            if (banner) {
                document.getElementById('bannerTitle').value = banner.title;
                document.getElementById('bannerSubtitle').value = banner.subtitle || '';
                document.getElementById('bannerBadge').value = banner.badge || '';
                document.getElementById('bannerOrder').value = banner.order || 0;
                document.getElementById('bannerActive').checked = banner.active !== false;
            }
            
            document.getElementById('bannerImagePreview').innerHTML = bannerImage ? `<img src="${bannerImage}" class="banner-preview">` : '';
            new bootstrap.Modal(document.getElementById('bannerModal')).show();
        }

        function editBanner(bannerId) {
            const banner = allBanners.find(b => b.banner_id === bannerId);
            if (banner) openBannerModal(banner);
        }

        async function saveBanner() {
            const bannerId = document.getElementById('bannerId').value;
            if (!bannerImage) { alert('Selectați o imagine pentru banner'); return; }
            
            const data = {
                title: document.getElementById('bannerTitle').value,
                subtitle: document.getElementById('bannerSubtitle').value,
                badge: document.getElementById('bannerBadge').value,
                order: parseInt(document.getElementById('bannerOrder').value) || 0,
                active: document.getElementById('bannerActive').checked,
                image: bannerImage
            };
            
            try {
                if (bannerId) await apiCall(`/admin/banners/${bannerId}`, { method: 'PUT', body: JSON.stringify(data) });
                else await apiCall('/admin/banners', { method: 'POST', body: JSON.stringify(data) });
                bootstrap.Modal.getInstance(document.getElementById('bannerModal')).hide();
                await loadBanners();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        async function deleteBanner(bannerId) {
            if (!confirm('Sigur doriți să ștergeți acest banner?')) return;
            try {
                await apiCall(`/admin/banners/${bannerId}`, { method: 'DELETE' });
                await loadBanners();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        function getLocationLabel(loc) { return { office: 'Oficiu', chisinau_airport: 'Aeroport Chișinău', iasi_airport: 'Aeroport Iași' }[loc] || loc; }
        function getStatusLabel(status) { return { pending: 'În așteptare', confirmed: 'Confirmată', completed: 'Finalizată', cancelled: 'Anulată' }[status] || status; }
        function getPartnerStatusLabel(status) { return { pending: 'Nou', contacted: 'Contactat', approved: 'Aprobat', rejected: 'Respins' }[status] || status; }

        // FAQ Functions
        function renderFaqs() {
            const tbody = document.getElementById('faqs-table');
            if (allFaqs.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center py-4 text-muted">Niciun FAQ adăugat</td></tr>';
                return;
            }
            tbody.innerHTML = allFaqs.map(f => `
                <tr>
                    <td>${f.order || 0}</td>
                    <td>${f.question_ro}</td>
                    <td>${f.question_ru}</td>
                    <td><span class="badge ${f.active ? 'bg-success' : 'bg-secondary'}">${f.active ? 'Activ' : 'Inactiv'}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="editFaq('${f.faq_id}')"><i class="bi bi-pencil"></i></button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteFaq('${f.faq_id}')"><i class="bi bi-trash"></i></button>
                    </td>
                </tr>
            `).join('');
        }

        async function loadFaqs() {
            try {
                allFaqs = await apiCall('/faqs?active_only=false');
                renderFaqs();
            } catch (error) { console.error(error); allFaqs = []; }
        }

        function openFaqModal(faq = null) {
            document.getElementById('faqModalTitle').textContent = faq ? 'Editează FAQ' : 'Adaugă FAQ';
            document.getElementById('faqForm').reset();
            document.getElementById('faqId').value = faq?.faq_id || '';
            
            if (faq) {
                document.getElementById('faqQuestionRo').value = faq.question_ro;
                document.getElementById('faqQuestionRu').value = faq.question_ru;
                document.getElementById('faqAnswerRo').value = faq.answer_ro;
                document.getElementById('faqAnswerRu').value = faq.answer_ru;
                document.getElementById('faqOrder').value = faq.order || 0;
                document.getElementById('faqActive').checked = faq.active !== false;
            }
            
            new bootstrap.Modal(document.getElementById('faqModal')).show();
        }

        function editFaq(faqId) {
            const faq = allFaqs.find(f => f.faq_id === faqId);
            if (faq) openFaqModal(faq);
        }

        async function saveFaq() {
            const faqId = document.getElementById('faqId').value;
            const data = {
                question_ro: document.getElementById('faqQuestionRo').value,
                question_ru: document.getElementById('faqQuestionRu').value,
                answer_ro: document.getElementById('faqAnswerRo').value,
                answer_ru: document.getElementById('faqAnswerRu').value,
                order: parseInt(document.getElementById('faqOrder').value) || 0,
                active: document.getElementById('faqActive').checked
            };
            
            try {
                if (faqId) await apiCall(`/admin/faqs/${faqId}`, { method: 'PUT', body: JSON.stringify(data) });
                else await apiCall('/admin/faqs', { method: 'POST', body: JSON.stringify(data) });
                bootstrap.Modal.getInstance(document.getElementById('faqModal')).hide();
                await loadFaqs();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        async function deleteFaq(faqId) {
            if (!confirm('Sigur doriți să ștergeți acest FAQ?')) return;
            try {
                await apiCall(`/admin/faqs/${faqId}`, { method: 'DELETE' });
                await loadFaqs();
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        // Legal Content Functions
        function loadLegalContent() {
            document.getElementById('termsContentRo').value = legalTerms.content_ro || '';
            document.getElementById('termsContentRu').value = legalTerms.content_ru || '';
            document.getElementById('privacyContentRo').value = legalPrivacy.content_ro || '';
            document.getElementById('privacyContentRu').value = legalPrivacy.content_ru || '';
        }

        async function saveLegalContent(type) {
            const contentRo = document.getElementById(`${type}ContentRo`).value;
            const contentRu = document.getElementById(`${type}ContentRu`).value;
            
            try {
                await apiCall(`/admin/legal/${type}`, { 
                    method: 'PUT', 
                    body: JSON.stringify({ content_ro: contentRo, content_ru: contentRu }) 
                });
                
                if (type === 'terms') {
                    legalTerms = { content_ro: contentRo, content_ru: contentRu };
                } else {
                    legalPrivacy = { content_ro: contentRo, content_ru: contentRu };
                }
                
                alert(type === 'terms' ? 'Termenii și Condițiile au fost salvate!' : 'Politica de Confidențialitate a fost salvată!');
            } catch (error) { alert('Eroare: ' + error.message); }
        }

        processAuth();
    </script>
</body>
</html>
